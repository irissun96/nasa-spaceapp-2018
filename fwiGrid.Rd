% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fwiGrid.R
\name{fwiGrid}
\alias{fwiGrid}
\title{Fire Weather Index applied to multigrids}
\usage{
fwiGrid(multigrid, mask = NULL, what = "FWI", nlat.chunks = NULL,
  restart.annual = TRUE, parallel = FALSE, ncores = NULL,
  max.ncores = 16, ...)
}
\arguments{
\item{multigrid}{containing Tm (temperature records in deg. Celsius); H (relative humidity records in \%);
r (last 24-h accumulated precipitation in mm); W (wind velocity records in Km/h). See details.}

\item{mask}{Optional. Binary grid (0 and 1, 0 for sea areas) with \code{dimensions} attribute \code{c("lat", "lon")}.}

\item{what}{Character string. What component of the FWI system is computed?. Default to \code{"FWI"}.
Note that unlike \code{\link{fwi1D}}, only one single component choice is possible in \code{fwiGrid}.
  See \code{\link{fwi1D}} for details and possible values.}

\item{nlat.chunks}{For an efficient memory usage, the computation of FWI can be split into 
latitudinal bands (chunks) sepparately. The number of chunks is controlled here. 
Default to \code{NULL} (i.e., no chunking applied).}

\item{restart.annual}{Logical. Should the calculation be restarted at the beginning of every year?
If the grid encompasses just one season (e.g. JJA...), this is the recommended option. Default to \code{TRUE}.}

\item{parallel}{Logical. Should parallel execution be used?}

\item{ncores}{Integer number of cores used in parallel computation. Self-selected number of
cores is used when \code{ncpus = NULL} (the default), or when \code{maxcores} exceeds the default \code{ncores} value.}

\item{max.ncores}{Integer. Upper bound for user-defined number of cores.}

\item{...}{Further arguments passed to \code{\link{fwi1D}}.}
}
\value{
A grid corresponding to the variable defined in argument \code{what}.
}
\description{
Implementation of the Canadian Fire Weather Index System for multigrids
}
\details{
\strong{Variable names}

The variables composing the input multigrid are expected to have standard names, as defined by the dictionary
 (their names are stored in the \code{multigrid$Variable$varName} component).
These are: \code{"tas"} for temperature, \code{"tp"} for precipitation, \code{"wss"} for windspeed. In the case of relative humidity,
either \code{"hurs"} or \code{"hursmin"} are accepted, the latter in case of FWI calculations according to the \dQuote{proxy} version
described in Bedia \emph{et al} 2014.

Note that the order of the variables within the multigrid is not relevant. These are indexed by variable names.

\strong{Landmask definition}

The use of a landsmask is highly recommended when using RCM/GCM data becasue (i) there is no point in calculating
FWI over sea areas and (ii) for computational efficiency, as sea gridboxes will be skipped before calculations.

The landmask must be a grid spatially consistent with the input multigrid. You can use 
\code{\link[transformeR]{interpGrid}} in combination with the \code{getGrid} method to ensure this condition is fulfilled.  . Its \code{data} component can be either a 2D or 3D array with the \code{dimensions} 
attribute \code{c("lat","lon")} or \code{c("time","lat","lon")} respectively. In the latter case, the length of the time 
dimension should be 1. Note that values of 0 correspond to sea areas (thus discarded for FWI calculation), being land areas any other 
values different from 0 (tipically 1 or 100, corresponding to the land/sea area fraction).   

\strong{Latitudinal chunking}

Splitting the calculation in latitudinal chunks is highly advisable, and absolutely necessary when
considering large spatial domains, otherwise running out of memory during the computation. The number
of latitudinal chunks need to be estimated on a case-by-case basis, but in general there are no restrictions in the
number of chunks that can be used, as long as it does not exceed the number of actual latitudes 
in the model grid.
}
\section{Parallel Processing}{


Parallel processing is enabled using the \pkg{parallel} package. 
Parallelization is undertaken by a FORK-type parallel socket cluster formed by \code{ncores}.
If \code{ncores} is not specified (default), \code{ncores} will be one less than the autodetected number of cores.
The maximum number of cores used for parallel processing can be set with the \code{max.ncores} argument, 
although this will be reset to the auto-detected number of cores minus 1 if this number is exceeded. Note that not all 
code, but just some critical loops within the function are parallelized.

In practice, parallelization does not always result in smaller execution times, due to the parallel overhead.
However, parallel computing may potentially provide a significant speedup for the 
particular case of large multimember datasets or large grids.
 
Parallel computing is currently not available for Windows machines.
}

\references{
\itemize{
\item Lawson, B.D. & Armitage, O.B., 2008. Weather guide for the Canadian Forest Fire Danger Rating System. Northern Forestry Centre, Edmonton (Canada).

\item van Wagner, C.E., 1987. Development and structure of the Canadian Forest Fire Weather Index (Forestry Tech. Rep. No. 35). Canadian Forestry Service, Ottawa, Canada.

\item van Wagner, C.E., Pickett, T.L., 1985. Equations and FORTRAN program for the Canadian forest fire weather index system (Forestry Tech. Rep. No. 33). Canadian Forestry Service, Ottawa, Canada.
}
}
\author{
J. Bedia \& M. Iturbide
}
